scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +mytheme
fig_exp2_sub1_dist
mDist_exp2 <-  dat_exp2 %>% filter(NSub == 1) %>% dplyr::group_by(cond) %>%
summarise(m_cDur = mean(curDur), n = dplyr::n(),
cDur_se = sd(curDur)/sqrt(n-1))
mDist_exp2
plot_mDist_exp2 <- ggplot(mDist_exp2,aes(cond, m_cDur, color = cond, fill = cond))+
geom_bar(stat='identity') +
geom_errorbar(aes(ymin = m_cDur - cDur_se, ymax = m_cDur + cDur_se), width =0.5) +
#geom_text(aes(label=paste("(",m_cDur,",",round(cDur_se),")") ),size=8, hjust=0.5, vjust=-2, color = 'black')+
labs(x = " ", y = " ") +
#coord_cartesian(ylim = c(0,1600))+
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank())+
theme(panel.grid.major=element_line(colour=NA))+
theme(axis.text.y = element_text(size=26,colour = "black"),
axis.text.x   = element_text(size=26, colour = "black"),
axis.title.y  = element_text(size=26, colour = "black"),
axis.title.x  = element_text(size=26, colour = "black"),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black")
)
if (saveFigure == TRUE){
ggsave("figures/plot_mDist_exp2.png", plot_mDist_exp2, width = 5, height = 5.5)
}
plot_mDist_exp2
fits_exp2 = quickpsy(dat_exp2, x = curDur, k =RP, prob = .5, grouping = .(cond, NSub))
fits_exp2_all = quickpsy(dat_exp2, x = curDur, k =RP,
grouping = .(cond))
fits_exp2_all
# plot fitted function
plot(fits_exp2)+ mytheme
fits_exp2_all = quickpsy(dat_exp2, x = curDur, k =RP,
grouping = .(cond))
fits_exp2_all
# plot fitted function
plot_fit_exp2 <- plot(fits_exp2_all) +
labs(x = "Durations (ms)", y = "Proportion of 'Long' responses") +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = c(0.7, 0.2), legend.title = element_blank())
plot_fit_exp2
par_exp2 = fits_exp2$par %>%
dplyr::select(-parinf,-parsup) %>%
spread(parn, par) %>%
rename(pse =p1, jnd = p2)  # rename columns
par_exp2$slope = 3/exp(par_exp2$pse/1000) #add slope
par_exp2
par_exp2 = fits_exp2$par %>%
dplyr::select(-parinf,-parsup) %>%
spread(parn, par) %>%
rename(pse =p1, jnd = p2)  # rename columns
par_exp2$slope = 3/exp(par_exp2$pse/1000) #add slope
par_exp2
mpse_exp2 = par_exp2%>%
group_by(cond) %>%
summarise(m_pse = mean(pse), m_jnd = mean(jnd), m_slope = mean(slope), n = n(),
pse_se = sd(pse)/sqrt(n-1),
jnd_se = sd(jnd)/sqrt(n-1),
slope_se = sd(slope)/sqrt(n-1))
mpse_exp2
exp2_jasp <- par_exp2%>%
unite(pse.jnd.slope, pse, jnd, slope)%>%
spread(cond, pse.jnd.slope)%>%
separate(DF, c("DF_pse", "DF_jnd","DF_slope"), sep = "_")%>%
separate(AF, c("AF_pse", "AF_jnd", "AF_slope"), sep = "_")
exp2_jasp
exp2_jasp <- par_exp2%>%
unite(pse.jnd.slope, pse, jnd, slope)%>%
spread(cond, pse.jnd.slope)%>%
separate(DF, c("DF_pse", "DF_jnd","DF_slope"), sep = "_")%>%
separate(AF, c("AF_pse", "AF_jnd", "AF_slope"), sep = "_")
exp2_jasp
plot_pse_exp2 <- ggplot(mpse_exp2,aes(cond, m_pse, color = cond, fill = cond))+
geom_bar(stat='identity') +
geom_errorbar(aes(ymin = m_pse - pse_se, ymax = m_pse + pse_se), width =0.5) +
geom_signif(comparisons=list(c("DF", "AF")), annotations="***", y_position = 1250, tip_length = 0, vjust=0.4, color = 'black') +
labs(x = " ", y = "Mean PSE (ms)") +
coord_cartesian(ylim = c(0,1300))+
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none")
plot_pse_exp2
plot_jnd_exp2 <- ggplot(mpse_exp2,aes(cond, m_jnd, color = cond, fill = cond))+
geom_bar(stat='identity') +
geom_errorbar(aes(ymin = m_jnd - jnd_se, ymax = m_jnd + jnd_se), width =0.5) +
geom_signif(comparisons=list(c("DF", "AF")), annotations="***", y_position = 330, tip_length = 0, vjust=0.4, color = 'black') +
labs(x = " ", y = "Mean JND (ms)") +
coord_cartesian(ylim = c(0,350))+
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none")
plot_jnd_exp2
plot_jnd_exp2_ppt <- ggplot(mpse_exp2,aes(cond, m_jnd, color = cond, fill = cond))+
geom_bar(stat='identity') +
geom_errorbar(aes(ymin = m_jnd - jnd_se, ymax = m_jnd + jnd_se), width =0.5) +
geom_signif(comparisons=list(c("DF", "AF")), annotations="***", y_position = 330, tip_length = 0, vjust=0.4, color = 'black') +
labs(x = "  ", y = "Mean JND (ms)") +
coord_cartesian(ylim = c(0,350))+
theme(legend.position = "none")+
geom_text(aes(label=paste("(",round(m_jnd),",",round(jnd_se, digits = 1),")") ),size=6, hjust=0.5, vjust=-3, color = 'black')+
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank())+
theme(panel.grid.major=element_line(colour=NA))+
theme(axis.text.y = element_text(size=26,colour = "black"),
axis.text.x   = element_text(size=26, colour = "black"),
axis.title.y  = element_text(size=26, colour = "black"),
axis.title.x  = element_text(size=26, colour = "black"),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))
plot_jnd_exp2_ppt
plot_slope_exp2 <- ggplot(mpse_exp2,aes(cond, m_slope, color = cond, fill = cond))+
geom_bar(stat='identity') +
geom_errorbar(aes(ymin = m_slope - slope_se, ymax = m_slope + slope_se), width =0.5) +
coord_cartesian(ylim = c(0,3))+
labs(x = "Exp 2", y = "Mean Slope") +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank())
plot_slope_exp2
Anova_exp2_pse <- ezANOVA(data = par_exp2, dv= pse, wid=NSub, within=.(cond))
Anova_exp2_pse
Anova_exp2_jnd <- ezANOVA(data = par_exp2, dv= jnd, wid=NSub, within=.(cond))
Anova_exp2_jnd
Anova_exp2_slope <- ezANOVA(data = par_exp2, dv= slope, wid=NSub, within=.(cond))
Anova_exp2_slope
sumfreq_exp3_sub1 <-  dat_exp3 %>% filter(NSub ==1) %>% group_by(cond, curDur) %>% summarise(count = n())
# rename columns
sumfreq_exp3_sub1$exp <- 'Exp3'
count_exp3 <- sum(sumfreq_exp3_sub1$count)/2
sumfreq_exp3_sub1$freq <- sumfreq_exp3_sub1$count/count_exp3*100
fig_exp3_sub1_dist <- ggplot(data=sumfreq_exp3_sub1, aes(x=curDur, y=freq, fill=cond)) +
geom_bar(stat="identity", position=position_dodge()) +
xlab('Durations (ms)') + ylab('Counts of trials for each participant') +
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +mytheme
fig_exp3_sub1_dist
mDist_exp3 <-  dat_exp3 %>% filter(NSub == 1) %>% dplyr::group_by(cond) %>%
summarise(m_cDur = mean(curDur), n = dplyr::n(),
cDur_se = sd(curDur)/sqrt(n-1))
mDist_exp3
plot_mDist_exp3 <- ggplot(mDist_exp3,aes(cond, m_cDur, color = cond, fill = cond))+
geom_bar(stat='identity') +
geom_errorbar(aes(ymin = m_cDur - cDur_se, ymax = m_cDur + cDur_se), width =0.5) +
labs(x = " ", y = " ") +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank())+
theme(panel.grid.major=element_line(colour=NA))+
theme(axis.text.y = element_text(size=26,colour = "black"),
axis.text.x   = element_text(size=26, colour = "black"),
axis.title.y  = element_text(size=26, colour = "black"),
axis.title.x  = element_text(size=26, colour = "black"),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black"))
plot_mDist_exp3
fits_exp3 = quickpsy(dat_exp3, x = curDur, k =RP, prob = .5,
grouping = .(cond, NSub), thresholds = FALSE)
# plot fitted function
plot(fits_exp3) + theme_classic()
fits_exp3_all = quickpsy(dat_exp3, x = curDur, k =RP,
grouping = .(cond), thresholds = FALSE)
fits_exp3_all
# plot fitted function
plot_fit_exp3 <- plot(fits_exp3_all) +
labs(x = "Durations (ms)", y = "Proportion of 'Long' responses") +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = c(0.7, 0.2), legend.title = element_blank())
plot_fit_exp3
par_exp3 = fits_exp3$par %>%
dplyr::select(-parinf,-parsup) %>%
spread(parn, par) %>%
rename(pse =p1, jnd = p2)  # rename columns
par_exp3$slope = 3/exp(par_exp3$pse/1000) #add slope
par_exp3
mpars_exp3 = par_exp3%>%
group_by(cond) %>%
summarise(m_pse = mean(pse), m_jnd = mean(jnd), m_slope = mean(slope), n = n(),pse_se = sd(pse)/sqrt(n-1), jnd_se = sd(jnd)/sqrt(n-1),slope_se = sd(slope)/sqrt(n-1))
mpars_exp3
exp3_jasp <- par_exp3%>%
unite(pse.jnd.slope, pse, jnd, slope)%>%
spread(cond, pse.jnd.slope)%>%
separate(`U-shaped`, c("U_pse", "U_jnd", "U_slope"), sep = "_")%>%
separate(`I T-shaped`, c("B_pse", "B_jnd", "B_slope"), sep = "_")
exp3_jasp
plot_pse_exp3 <- ggplot(mpars_exp3,aes(cond, m_pse, color = cond, fill = cond))+
geom_bar(stat='identity') +
geom_errorbar(aes(ymin = m_pse - pse_se, ymax = m_pse + pse_se), width =0.5) +
coord_cartesian(ylim = c(0,1300)) +
labs(x = " ", y = "Mean PSE (ms)") +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank())
plot_pse_exp3
plot_pse_exp3 <- ggplot(mpars_exp3,aes(cond, m_pse, color = cond, fill = cond))+
geom_bar(stat='identity') +
geom_errorbar(aes(ymin = m_pse - pse_se, ymax = m_pse + pse_se), width =0.5) +
coord_cartesian(ylim = c(0,1300)) +
labs(x = " ", y = "Mean PSE (ms)") +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank())
plot_pse_exp3
plot_jnd_exp3 <- ggplot(mpars_exp3,aes(cond, m_jnd, color = cond, fill = cond))+
geom_bar(stat='identity') +
geom_errorbar(aes(ymin = m_jnd - jnd_se, ymax = m_jnd + jnd_se), width =0.5) +
coord_cartesian(ylim = c(0,300))+
geom_signif(comparisons=list(c("U-shaped", "I T-shaped")), annotations="***", y_position = 250, tip_length = 0, vjust=0.4, color = 'black') +
labs(x = " ", y = "Mean JND (ms)") +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none")
plot_jnd_exp3
plot_slope_exp3 <- ggplot(mpars_exp3,aes(cond, m_slope, color = cond, fill = cond))+
geom_bar(stat='identity') +
geom_errorbar(aes(ymin = m_slope - slope_se, ymax = m_slope + slope_se), width =0.5) +
coord_cartesian(ylim = c(0,3))+
labs(x = "Exp 3", y = "Mean Slope") +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank())
plot_slope_exp3
Anova_exp3_pse<- ezANOVA(data = par_exp3, dv= pse, wid=NSub, within=.(cond))
Anova_exp3_pse
Anova_exp3_jnd<- ezANOVA(data = par_exp3, dv= jnd, wid=NSub, within=.(cond))
Anova_exp3_jnd
Anova_exp3_slope<- ezANOVA(data = par_exp3, dv= slope, wid=NSub, within=.(cond))
Anova_exp3_slope
Anova_exp3_pse<- ezANOVA(data = par_exp3, dv= pse, wid=NSub, within=.(cond))
Anova_exp3_pse
Anova_exp3_jnd<- ezANOVA(data = par_exp3, dv= jnd, wid=NSub, within=.(cond))
Anova_exp3_jnd
Anova_exp3_slope<- ezANOVA(data = par_exp3, dv= slope, wid=NSub, within=.(cond))
Anova_exp3_slope
fig_mDist_all <- plot_grid(plot_mDist_exp1, plot_mDist_exp2, plot_mDist_exp3,  nrow = 1, labels = c("Exp 1", "Exp 2", "Exp 3"), rel_widths = c(3,3,3))
fig_mDist_all
fig_fit <- plot_grid(plot_fit_exp1, plot_fit_exp2, plot_fit_exp3,  nrow = 1, labels = c("Exp 1", "Exp 2", "Exp 3"), rel_widths = c(3,3,3))
fig_fit
plot_grid(plot_fit_exp2, plot_pse_exp2,plot_jnd_exp2,  nrow = 1, labels = c("A", "B", "C"), rel_widths = c(4,3,3))
plot_grid(plot_fit_exp2, plot_pse_exp2, plot_jnd_exp2,  nrow = 1, labels = c("A", "B", "C"), rel_widths = c(4,3,3))
plot_grid(plot_fit_exp1, plot_pse_exp1, plot_jnd_exp1,  nrow = 1, labels = c("A", "B", "C"), rel_widths = c(4,3,3))
plot_grid(plot_fit_exp2, plot_pse_exp2, plot_jnd_exp2,  nrow = 1, labels = c("A", "B", "C"), rel_widths = c(4,3,3))
plot_grid(plot_fit_exp3, plot_pse_exp3, plot_jnd_exp3,  nrow = 1, labels = c("A", "B", "C"), rel_widths = c(4,3,3))
plot_grid(plot_slope_exp1, plot_slope_exp2, plot_slope_exp3,  nrow = 1, labels = c("A", "B", "C"), rel_widths = c(3,3,3))
ggplot(data=sumfreq_exp1_sub1, aes(x=curDur, y=freq, fill=cond, color = cond)) +
geom_bar(stat="identity", position=position_dodge(),width = 3) +
geom_point()+
xlab('') + ylab('Prob. (%)') +
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_y_continuous(breaks=seq(0, 50, 5)) +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank()) + facet_wrap(~cond)
ggplot(data=sumfreq_exp2_sub1, aes(x=curDur, y=freq, fill=cond, color = cond)) +
geom_bar(stat="identity", position=position_dodge(), width = 3) +
geom_point()+
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_y_continuous(breaks=seq(0, 50, 10)) +
xlab('') + ylab('Prob. (%)') +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = 'none', legend.title = element_blank()) + facet_wrap(~cond)
ggplot(data=sumfreq_exp3_sub1, aes(x=curDur, y=freq, fill=cond, color = cond)) +
geom_bar(stat="identity", position=position_dodge(), width = 3) +
geom_point()+
xlab('Durations (ms)') + ylab('Prob. (%)') +
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_y_continuous(breaks=seq(0, 50, 10)) +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank())+ facet_wrap(~cond)
plot_grid(fig_exp1_sub1_dist2, fig_exp2_sub1_dist_2, fig_exp3_sub1_dist2,  ncol = 1, labels = c("A", "B", "C"), rel_heights = c(3,3,3))
plot_grid(fig_exp1_sub1_dist2, fig_exp2_sub1_dist_2, fig_exp3_sub1_dist2,  ncol = 1, labels = c("A", "B", "C"), rel_heights = c(3,3,3))
mergcounts_sub1 <- rbind(data.frame(sumfreq_exp1_sub1), data.frame(sumfreq_exp2_sub1), data.frame(sumfreq_exp3_sub1))
mergcounts_sub1 <- rbind(data.frame(sumfreq_exp1_sub1), data.frame(sumfreq_exp2_sub1), data.frame(sumfreq_exp3_sub1))
sumfreq_exp1_sub1 <-  dat_exp1 %>% filter(NSub == 1) %>% group_by(cond, curDur) %>% summarise(n = n(), x = mean(X))
count_exp1 <- sum(sumfreq_exp1_sub1$count)/2
sumfreq_exp1_sub1$exp <- 'Exp1'
sumfreq_exp1_sub1$freq <- sumfreq_exp1_sub1$count/count_exp1*100
sumfreq_exp1_sub1 <-  dat_exp1 %>% filter(NSub == 1) %>% group_by(cond, curDur) %>% summarise(n = n(), x = mean(X))
count_exp1 <- sum(sumfreq_exp1_sub1$count)/2
sumfreq_exp1_sub1$exp <- 'Exp1'
sumfreq_exp1_sub1 <-  dat_exp1 %>% filter(NSub == 1) %>% group_by(cond, curDur) %>% summarise(count = n())
count_exp1 <- sum(sumfreq_exp1_sub1$count)/2
sumfreq_exp1_sub1$exp <- 'Exp1'
sumfreq_exp1_sub1$freq <- sumfreq_exp1_sub1$count/count_exp1*100
# rename columns
fig_exp1_sub1_dist <- ggplot(data=sumfreq_exp1_sub1, aes(x=curDur, y=count, fill=cond)) +
geom_bar(stat="identity", position=position_dodge()) +
#geom_smooth(method="loess",se = FALSE)+
xlab('Durations (ms)') + ylab('Counts of trials for each participant') +
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +mytheme+ facet_wrap(~cond)
fig_exp1_sub1_dist
if (saveFigure == TRUE){
ggsave("figures/fig_exp1_sub1_dist.svg", fig_exp1_sub1_dist)
}
ggplot(data=sumfreq_exp2_sub1, aes(x=curDur, y=freq, fill=cond, color = cond)) +
geom_bar(stat="identity", position=position_dodge(), width = 3) +
geom_point()+
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_y_continuous(breaks=seq(0, 50, 10)) +
xlab('') + ylab('Prob. (%)') +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = 'none', legend.title = element_blank()) + facet_wrap(~cond)
ggplot(data=sumfreq_exp3_sub1, aes(x=curDur, y=freq, fill=cond, color = cond)) +
geom_bar(stat="identity", position=position_dodge(), width = 3) +
geom_point()+
xlab('Durations (ms)') + ylab('Prob. (%)') +
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_y_continuous(breaks=seq(0, 50, 10)) +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank())+ facet_wrap(~cond)
plot_grid(fig_exp1_sub1_dist2, fig_exp2_sub1_dist_2, fig_exp3_sub1_dist2,  ncol = 1, labels = c("A", "B", "C"), rel_heights = c(3,3,3))
fig_exp1_sub1_dist2 <- ggplot(data=sumfreq_exp1_sub1, aes(x=curDur, y=freq, fill=cond, color = cond)) +
geom_bar(stat="identity", position=position_dodge(),width = 3) +
geom_point()+
xlab('') + ylab('Prob. (%)') +
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_y_continuous(breaks=seq(0, 50, 5)) +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank()) + facet_wrap(~cond)
fig_exp1_sub1_dist2
plot_grid(fig_exp1_sub1_dist2, fig_exp2_sub1_dist_2, fig_exp3_sub1_dist2,  ncol = 1, labels = c("A", "B", "C"), rel_heights = c(3,3,3))
plot_grid(fig_exp1_sub1_dist2, fig_exp2_sub1_dist_2, fig_exp3_sub1_dist2,  ncol = 1, labels = c("A", "B", "C"), rel_heights = c(3,3,3))
plot_grid(fig_exp1_sub1_dist2, fig_exp2_sub1_dist_2, fig_exp3_sub1_dist2,  ncol = 1, labels = c("A", "B", "C"), rel_heights = c(3,3,3))
fig_exp3_sub1_dist2 <- ggplot(data=sumfreq_exp3_sub1, aes(x=curDur, y=freq, fill=cond, color = cond)) +
geom_bar(stat="identity", position=position_dodge(), width = 3) +
geom_point()+
xlab('Durations (ms)') + ylab('Prob. (%)') +
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_y_continuous(breaks=seq(0, 50, 10)) +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank())+ facet_wrap(~cond)
fig_exp2_sub1_dist_2 <- ggplot(data=sumfreq_exp2_sub1, aes(x=curDur, y=freq, fill=cond, color = cond)) +
geom_bar(stat="identity", position=position_dodge(), width = 3) +
geom_point()+
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_y_continuous(breaks=seq(0, 50, 10)) +
xlab('') + ylab('Prob. (%)') +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = 'none', legend.title = element_blank()) + facet_wrap(~cond)
fig_exp3_sub1_dist2 <- ggplot(data=sumfreq_exp3_sub1, aes(x=curDur, y=freq, fill=cond, color = cond)) +
geom_bar(stat="identity", position=position_dodge(), width = 3) +
geom_point()+
xlab('Durations (ms)') + ylab('Prob. (%)') +
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_y_continuous(breaks=seq(0, 50, 10)) +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank())+ facet_wrap(~cond)
plot_grid(fig_exp1_sub1_dist2, fig_exp2_sub1_dist_2, fig_exp3_sub1_dist2,  ncol = 1, labels = c("A", "B", "C"), rel_heights = c(3,3,3))
fig_exp1_sub1_dist2 <- ggplot(data=sumfreq_exp1_sub1, aes(x=curDur, y=freq, fill=cond, color = cond)) +
geom_bar(stat="identity", position=position_dodge(),width = 3) +
geom_point()+
xlab('') + ylab('Prob. (%)') +
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_y_continuous(breaks=seq(0, 50, 5)) +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank()) + facet_wrap(~cond)
fig_exp2_sub1_dist_2 <- ggplot(data=sumfreq_exp2_sub1, aes(x=curDur, y=freq, fill=cond, color = cond)) +
geom_bar(stat="identity", position=position_dodge(), width = 3) +
geom_point()+
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_y_continuous(breaks=seq(0, 50, 10)) +
xlab('') + ylab('Prob. (%)') +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = 'none', legend.title = element_blank()) + facet_wrap(~cond)
fig_exp3_sub1_dist2 <- ggplot(data=sumfreq_exp3_sub1, aes(x=curDur, y=freq, fill=cond, color = cond)) +
geom_bar(stat="identity", position=position_dodge(), width = 3) +
geom_point()+
xlab('Durations (ms)') + ylab('Prob. (%)') +
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_y_continuous(breaks=seq(0, 50, 10)) +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none", legend.title = element_blank())+ facet_wrap(~cond)
plot_grid(fig_exp1_sub1_dist2, fig_exp2_sub1_dist_2, fig_exp3_sub1_dist2,  ncol = 1, labels = c("A", "B", "C"), rel_heights = c(3,3,3))
mergcounts_sub1 <- rbind(data.frame(sumfreq_exp1_sub1), data.frame(sumfreq_exp2_sub1), data.frame(sumfreq_exp3_sub1))
fig_combine_sub1_dist <- ggplot(data=mergcounts_sub1, aes(x=curDur, y=freq,color = exp, fill = exp))+geom_point()+geom_bar(stat = "identity")+facet_wrap(~cond, nrow = 3)+
xlab('Duration of intervals (ms)') + ylab('Frequencies of intervals (%)') +
scale_x_continuous(breaks=seq(0, 1600, 200)) +
scale_color_manual(values = c('#d9d9d9','#969696','#252525' )) +
scale_fill_manual(values = c('#d9d9d9','#969696','#252525')) +
theme(legend.position = "none", legend.title = element_blank())
fig_combine_sub1_dist
plot_grid(plot_mDist_exp1, plot_mDist_exp2, plot_mDist_exp3,  ncol = 3, labels = c("A", "B", "C"), rel_widths = c(3,3,3))
#customize theme
theme_new <- theme_bw() +
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line=element_line(colour="black"),
strip.background = element_rect(color = "white", fill = "white"),
panel.grid = element_blank())
models <- c('model1', 'model2','model3', 'model4','model5')
expDat <- list(dat_exp1, dat_exp2, dat_exp3)
#load the data and remove the outliers
par_GLM_observed <-read.csv('../data/par_observed.csv') %>% filter(!((NSub == 10|NSub == 6 ) & (cond == 'AF'| cond =='DF')))%>% filter(!((NSub == 1) & (cond == 'PS'| cond =='NS')))
modelresults<- read.csv("../data/modelresults.csv")  %>% filter(!((NSub == 10|NSub == 6) & (cond == 'AF'| cond =='DF')))%>% filter(!((NSub == 1) & (cond == 'PS'| cond =='NS')))
displayModellist <- c("Bisection Model",  "Spacing Model", "Ensemble Mean",  "Two-stage Ensemble Mean", "EDA")
#combine oberserved and predicated PSEs and JNDs
par_comb = left_join(modelresults, par_GLM_observed, by = c('NSub', 'cond'))
par_comb$errpse <- par_comb$PSEmap-par_comb$pse
par_comb$errjnd <- par_comb$JNDmap-par_comb$jnd
par_comb$model = factor(par_comb$model, labels = displayModellist)
head(par_comb)
#calculate AIC and BIC
numParam <- 3
mpar_comb <- par_comb %>% dplyr::group_by(model, cond) %>%
dplyr::summarise(sumerrpse=sum((errpse)^2), n=n(),
sumerrjnd=sum((errjnd)^2)) %>%
dplyr::group_by(model, cond) %>%
summarise(aicPse= 2 * numParam +  n*log(sumerrpse/n),
bicPse = n*log(sumerrpse/n) + numParam*log(n),
aicJnd= 2 * numParam +  n*log(sumerrjnd/n),
bicJnd = n*log(sumerrjnd/n) + numParam*log(n), )
### show the mean in each model
m_par <- modelresults %>% group_by(model, cond, NSub) %>%
summarise(xmean= mean(xmean), xmeanhat= mean(xmeanhat))  %>%
group_by(model, cond) %>%
summarise(xmean= mean(xmean), xmeanhat= mean(xmeanhat))
par_comb <- arrange(transform(par_comb,
cond=factor(cond,levels=c("PS","DF","U-shaped","NS","AF","I T-shaped"))),cond)
cbp1 <- c( "#CC79A7", "#F0E442", "#0072B2", "#E69F00", "#D55E00")
plt_ErrorScatter = ggplot(par_comb, aes(errpse, errjnd, color = model, shape = model)) +
geom_hline(yintercept = 0, linetype='dashed')+ geom_vline(xintercept = 0, linetype='dashed')+
geom_point() +
xlab('Prediction error in the PSEs (ms)')+ ylab('Prediction error in the JNDs (ms)')+
scale_color_manual(values = cbp1) +
scale_shape_manual(values=c(0, 1, 2, 8, 16))+
facet_wrap(~cond)+
theme_new+ theme(legend.position = 'top')
plt_ErrorScatter
m_parcomb <- par_comb %>% dplyr::group_by(model, cond) %>%
dplyr::summarise(mPSEmap=mean(PSEmap), pse = mean(pse), mJNDmap=mean(JNDmap),jnd = mean(jnd),
merrpse =mean(errpse), merrjnd = mean(errjnd),n=n(),
PSEmap_se = sd(PSEmap)/sqrt(n-1), JNDmap_se = sd(JNDmap)/sqrt(n-1),
errpse_se =sd(errpse)/sqrt(n-1), errjnd_se =sd(errjnd)/sqrt(n-1))
m_par_observed <- par_GLM_observed %>% dplyr::group_by(cond) %>%
dplyr::summarise(mpse=mean(pse), mjnd= mean(jnd), n=n(),
pse_se =sd(pse)/sqrt(n-1), jnd_se =sd(jnd)/sqrt(n-1))
m_par_observed$mPSEmap<-m_par_observed$mpse
m_par_observed$mJNDmap<-m_par_observed$mjnd
m_parcomb2 <- arrange(transform(m_parcomb,
cond=factor(cond,levels=c("PS","DF","U-shaped","NS","AF","I T-shaped"))),cond)
fig_estimation = ggplot(m_parcomb2, aes(x=mPSEmap, y=mJNDmap, color = model)) +
geom_point(data =m_par_observed, aes(x = mpse, y =mjnd, size=2), width =2, shape =16, alpha = 0.5,  color = 'black') +
geom_point(data = par_comb, aes(x = pse, y =jnd), alpha = 0.25, color = 'lightgray') +
geom_point() +
geom_errorbar(aes(ymax=mJNDmap+JNDmap_se, ymin=mJNDmap-JNDmap_se), size=0.6)+
geom_errorbarh(aes(xmax=mPSEmap+PSEmap_se, xmin=mPSEmap-PSEmap_se),size=0.6)+
ylab('Observed JNDs (ms)')+xlab('Observed PSEs (ms)') +
scale_color_manual(values = cbp1) +
theme_new+ theme(legend.position = 'top') +
facet_wrap(.~cond,  ncol=3)+
scale_size(guide = 'none')
#+xlim(600,1200)+ylim(45,200)
fig_estimation
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
source('dataana.R')
fits_exp2_all = quickpsy(dat_exp2, x = curDur, k =RP,
grouping = .(cond))
fits_exp2_all
# plot fitted function
plot_fit_exp2 <- plot(fits_exp2_all) +
labs(x = "Durations (ms)", y = "Proportion of 'Long' responses") +
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = c(0.7, 0.2), legend.title = element_blank())
plot_fit_exp2
par_exp2 = fits_exp2$par %>%
dplyr::select(-parinf,-parsup) %>%
spread(parn, par) %>%
rename(pse =p1, jnd = p2)  # rename columns
par_exp2$slope = 3/exp(par_exp2$pse/1000) #add slope
par_exp2
exp2_jasp <- par_exp2%>%
unite(pse.jnd.slope, pse, jnd, slope)%>%
spread(cond, pse.jnd.slope)%>%
separate(DF, c("DF_pse", "DF_jnd","DF_slope"), sep = "_")%>%
separate(AF, c("AF_pse", "AF_jnd", "AF_slope"), sep = "_")
exp2_jasp
plot_pse_exp2 <- ggplot(mpse_exp2,aes(cond, m_pse, color = cond, fill = cond))+
geom_bar(stat='identity') +
geom_errorbar(aes(ymin = m_pse - pse_se, ymax = m_pse + pse_se), width =0.5) +
geom_signif(comparisons=list(c("DF", "AF")), annotations="***", y_position = 1250, tip_length = 0, vjust=0.4, color = 'black') +
labs(x = " ", y = "Mean PSE (ms)") +
coord_cartesian(ylim = c(0,1300))+
scale_color_manual(values = c('gray','black')) +
scale_fill_manual(values = c('gray','black')) +
theme(legend.position = "none")
plot_pse_exp2
